# 谱匣 - “键谱”网页的辅助增强程序

> 增加: “谱匣”的辅助增强程序 `KeymapTray.exe` ^_^

## 功能

* 让“键谱”像一个独立的单机程序一样运行（其实还是需要系统的浏览器）

* 为“键谱”增加文件存储能力，键盘映射配置会存储在同目录下的同名文件里

* 支持命令行参数自定义载入的键谱及显示界面

  ```
  -P 键谱名
  -L 键盘层 : [0~9]
  -V 视图 : [k/l/j] 键图 / 键表 / 数据
  -S 主键盘大小 : [0~3] 隐藏 / 60% / 80% / 标准
  -X 扩展键区 ：[0/1] 关闭 / 打开
  -H 键帽提示 : [0/1] 关闭 / 打开
  -M 界面模式 : [t/s] 分页 / 单页
  ```

  示例：

  打开键谱“Photoshop”，切换到层2，显示键图，60%键盘大小，关闭扩展键区，打开键帽提示，单页模式。

  `keymap.exe -P Photoshop -L 2 -V k -S 1 -X 0 -H 1 -M s`

* 单实例运行，再次运行会切换至已运行的实例，且新的命令行参数仍会生效

## “键谱”网页的更新/修改

“谱匣”不绑定“键谱”网页，`keymap.html` 仍是独立文件，并且仍可以单独使用（直接在浏览器中打开），也可直接修改。

如果“键谱”网页有更新版本了，直接下载 `keymap.html` 覆盖就行。

## KeymapTray.exe - “谱匣”的辅助增强程序

### 功能

* 全局热键呼出【键谱】窗口

* 可根据当前窗口显示对应的“键谱”

### 配置文件 `keymapTray.ini`

```ini
[Default]
; 两种【键谱】热键模式：
;   注：使用 AHK 热键格式，=空 表示不设置该热键
; 1. 组合键（常用 AHK 修饰键：^:Ctrl, !:Alt, +:Shift, #:Win）
hotkey1=^!k
; 2. 单键双击
hotkey2=Esc
[Keymaps]
; “键谱”与应用窗口对应关系
; 应用窗口标题关键字 = “谱匣”参数
; "应用窗口标题关键字"格式同 AHK 的 WinTitle，唯一限制是不能包含“=”
EmEditor = -P EmEditor -V k -S 1 -X 0 -H 1 -M t
```

## 安装

下载后解压缩，将 `keymap.html` 放到与 `keymap.exe` 同一个目录。

## 运行

两种方式：

* 直接运行“谱匣” `keymap.exe`

* 运行 `keymapTray.exe`

  > 无需预先运行 `keymap.exe`

  + 运行后在右下角“系统托盘”中会显示 `KeyMap Tray` 图标，右键单击显示菜单。

  + 按热键即可呼出【键谱】窗口，在【键谱】窗口中按热键可隐藏【键谱】窗口。

  + 右键菜单中选择 `Exit` 退出时会同时退出【谱匣】程序。
