# 【键谱】使用手册

## 基础概念、功能和操作

* `键谱`

  `键谱` 是这个应用的名字，同时也用来指代“一份完整的快捷键清单”。

  一般会将一个软件、应用的所有快捷键清单记录到一个 `键谱` 中。

  + 【操作】点击顶部的“键谱名字”，就可以新建和切换键谱。

* `快捷键`

  `快捷键` 指程序、软件中实现特定功能的按键组合，如：Win + E、Alt + Tab

  + 【操作】点击键盘图中的按键，就可以录入快捷键的按键组合及功能说明信息。

  + 一个键上可以录入多组快捷键。

  + 一个键上有多组快捷键时，可以将其中某个快捷键设置为`主快捷键`，使它的信息优先显示在键帽上。

* `主键`、`修饰键`、`组合键`

  一个快捷键往往需要同时按下多个按键，其中像 Alt、Ctrl、Shift、Win 这种称为`修饰键`，而像 A、Tab、Delete 这种称为`主键`，一个或多个修饰键加一个主键就组成了`组合键`。

  + 在录入快捷键时可以选择多个`修饰键`（Alt、Ctrl、Shift ...）。

* `键盘层`

  在一些定制化键盘上有特殊开关，当开关处于不同位置时，同一个按键被按下时会触发不同的功能。

  对处于不同开关状态下的键盘，我们称之为一个`键盘层`。

  【键谱】支持`键盘层`的概念，并且可以按照需要来自由设定`键盘层`。

  + 每个`键谱`至少有一个`键盘层`（普通键盘可以认为只有一个`键盘层`）。

  + 每个快捷键都必定属于某一个`键盘层`。

  + 【操作】点击上部的键盘层列表，可以切换不同的键盘层。

  + 可以为每个`键谱`设置键盘层数量

  + 按 F2 或双击键盘层编号可以修改键盘层的名字。

## 快捷键的展示

【键谱】会展示`当前键盘层`的所有快捷键。
  
* 右上角的`键图`、`键表`、`数据` tab 可以切换不同的展示模式：

  + `键图`

    一个虚拟键盘图，记录的快捷键信息会展示在对应`主键`上。

  + `键表`

    展示`当前键盘层`的所有快捷键列表，按`主键`的字母序分组或用户的自定义分组排列。

  + `数据`

    显示`当前键谱`（不仅是`当前键盘层`）的完整数据，可以复制保存到文件，也可以将之前保存的文件数据粘贴进来并导入。

* 鼠标指向`键图`上的按键时，会展示以这个按键为`主键`的所有快捷键。

* 键帽提示：在键帽上显示快捷键信息（按 Tab 开启）

  开启`键帽提示`后，会在键帽上显示快捷键的修饰键，以及快捷键的摘要信息。

  由于键帽上只能显示一个快捷键信息，【键谱】会根据以下规则决定显示哪个快捷键：

  1. 如果用户没有筛选修饰键，优先显示`主快捷键`，如果没有主快捷键，则显示单键（无修饰键）的快捷键，如果单键也没有，但快捷键只有一组，则显示这个快捷键，如果不止一组，则不显示，只高亮显示按键；

  2. 如果筛选了修饰键，就显示包含修饰键的快捷键，如果没有包含的，就不显示，如果有多条，优先显示完全匹配的那条，没有完全匹配的，显示第一个匹配的快捷键。

* 筛选

  + 在`键图`中右键点击修饰键，可以筛选包含该修饰键的快捷键。

  + 按住 \"Ctrl\" 可同时选择多个键进行筛选，结果为同时包含这些键的快捷键。

  + 在`键表`中提供了修饰键多选工具栏进行筛选。

  + 在`键表`中还提供了根据快捷键信息文字进行筛选的功能。

* 键盘布局（按 m / Shift+m 切换布局）

  一个`键谱`可以同时有两个按键布局：PC 和 Mac，这两个布局有一些键是不同的，基本上除字母键、Fn键以外的都不一样，使用不同布局按键的快捷键也会区分显示。

* `分页模式` 和 `单页模式`

  最右上角有一个切换开关，可以让【键谱】切换不同的界面

  + `分页模式`

    【键谱】的默认界面，有完整的工具栏和`键图`、`键表`、`数据`三个 tab。

  + `单页模式`

    将`键图`和`键表`整合到一起，并隐藏工具栏，一般用于对外展示和打印。

* `截图`

  【键谱】可以生成`单页模式`下整个页面的截图，无需滚动截屏工具。

* 【键谱】会保存每个`键谱`的设置和状态，在下次打开时自动恢复。（除了`当前是哪个键盘层`，每次打开都会打开 0 层）

## 进阶

* 【写在前面】

  【键谱】很多功能都会涉及到`键名`，对于`键名`你需要知道以下这些：

  + `键名`：每个按键唯一的名字，一般与键帽上显示的一致，但为了显示效果，有些键名会和键帽上不一致（如：上下左右方向键）

  + `键名`区分大小写（就是说，Tab 和 tab 是两个不同的键名）

  + 获取键名：点击按键，在弹出的快捷键设置对话框中，最右边的按键名就是键名

* 在键帽上显示的修饰键

  + 键帽上的修饰键有三种显示方式：

    1. 键名：修饰键的键名

    2. 缩写：键名的缩写，一般为一个字母

    3. 仅颜色：启用修饰键颜色后，显示修饰键对应颜色的小方块

  + 修饰键缩写：键名1::缩写1, 键名2::缩写2, ...

    对未设置缩写的修饰键，默认为键名首字母

  + 修饰键颜色：键名1::颜色1, 键名2::颜色2, ...

    颜色支持两种格式：颜色值，左上颜色值/右下颜色值

    1. 单色格式：

       整个修饰键一种背景色

    2. 双色格式：

       修饰键的背景色由 左上/右下 两个颜色组合，各占 50%

       颜色可以为空，为空部分显示为白色，且占比会缩小到 20%

  + 启用修饰键颜色后，所有修饰键显示时都会使用设定的背景颜色

    对未设置颜色的修饰键，默认为透明背景

  + 颜色和显示模式可以搭配组合

* 分组

  + 录入快捷键信息时，可以为快捷键选择分组

  + 键帽会显示键帽上快捷键的分组颜色

  + `键表`可以按照分组来排列、显示快捷键列表

  + `键表`中不按分组显示时，快捷键上会有代表分组色的小颜色块

  + 自定义分组颜色及显示名称："g1::颜色值1::显示名称1, g2::颜色值2::显示名称2, ..."

    可以不设置显示名称，会显示前面的 g1、g2 ...

* 自定义修饰键

  有些软件会用不常用的键作为修饰键，比如“用 Caps 作为快捷键的修饰键”。【键谱】提供了自定义修饰键的功能，可以将任意按键设定为修饰键，并在录入快捷键信息时选择这些键。

  + 【设置】自定义修饰键：修饰键名以英文逗号(,)分隔。

  + 支持使用扩展键作为修饰键。

* `扩展键盘`

  “有些快捷键会包含鼠标键”，“定制USB小键盘上的按键不是标准键盘上的键”，对于这种情况，【键谱】提供了`扩展键盘`功能，可以在`扩展键盘`里定义标准键盘上没有的按键，然后这些键就可以和其他键一样使用了。

  + 【设置】扩展键盘：扩展键名以英文逗号(,)分隔。

    以 "#" 开头的扩展键会显示为纯文字（去除#）而非按键，单个 "#" 会显示一个键位大小的空白。

    支持自定义布局，设置参数中的每一行代表一行扩展键，不含扩展键的行会忽略（空行或只有逗号的行）。

* `演示模式`

  如果你想把自己设置好的一个`键谱`交给别人使用，而又怕他误操作破坏了`键谱`的内容时，你可以用【键谱】的特殊模式——`演示模式`。

  在`演示模式`下，只会展示预设好的`键谱`，并且关闭了所有修改、编辑操作，只有展示功能。

  进入`演示模式`需要有对应的 `present.js` 文件，